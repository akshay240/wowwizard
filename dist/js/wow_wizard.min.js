!function(e){e.fn.wowWizard=function(i){"use strict";function t(){var e=g.settings.steps[x];if(e.isDependent&&(e=n(e)),!e)throw new Error("Wrong dependency accross the steps.");if(!m.isStepTypeAllowed(e))throw new Error("Step type is not allowed: "+e.type);var i=u(e);g.html(i).find(".wow-wizard-content").css("opacity","0"),a(e,i),w.apply(i);var t="multiple_image_choice"==e.type?1e3:300;setTimeout(function(){g.find(".wow-wizard-content").animate({opacity:1},500),g.find(".loader").fadeOut(200)},t),l(e),b.update()}function n(e){for(var i=0;i<e.steps.length;i++){var t=e.steps[i],n=g.settings.steps[t.triggerStep];if(n.given_answer==t.triggerAnswer)return t}}function a(i,t){var n=t.find(".wow-wizard-step-indicator");n.each(function(i){var t=e(this).data("step");_>t&&e(this).find(".step-id").html('<div class="check"></div>'),x==t&&e(this).addClass("visited"),e(this).click(function(){r(e(this))})});var a=t.find("#wow-alert");a.fadeOut(0);var s=t.find("#wow-wizard-next-step");if(s.click(function(){o()}),e("div.single-choice-button").click(function(){e(this).data("selected",!0),e(this).data("selected"),o()}),"form"==i.type&&e(g).bind("keypress",function(e){var i=e.keyCode||e.which;13==i&&o()}),"multiple_image_choice"==i.type){var c=g.find(".multiple-image-choice");c.each(function(i){var t=e(this);t.isAvailable=!0,t.click(function(){t.data("selected")?h("multiple_image_choice",t):f("multiple_image_choice",t)})})}}function o(){var e=g.settings.steps[x];return e.isDependent&&(e=n(e)),s(e)?(++x>=g.settings.steps.length?(x--,d(g)):(x>_&&_++,t(g),g.settings.onNextStep()),!0):!1}function s(i){switch(i.type){case"single_choice":return g.find(".single-choice-button").each(function(i){e(this).data("selected")&&(r=e(this).data("value"))}),i.given_answer=r,m.debug&&console.log(i.given_answer),!0;case"multiple_choice":var t,n=[];return g.find(".multiple-choice-choice").each(function(){e(this).hasClass("active")&&n.push(e(this).data("value"))}),0==n.length?(t=i.errors.required?i.errors.required:g.settings.errors.form.required,c(i,t)):(i.given_answer=n,m.debug&&console.log(i.given_answer),!0);case"form":var t,a=g.find("input"),n=[],o=!1;return a.each(function(a){if(""!=e(this).val())n[a]=e(this).val();else if(e(this).data("required"))return o=!0,t=i.errors.required?i.errors.required:g.settings.errors.form.required,e(this).css("border-color","red"),!0;if("email"==e(this).attr("type")){var s=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return s.test(e(this).val())||(o=!0,e(this).css("border-color","red"),t=i.errors.email?i.errors.email:g.settings.errors.form.email),!0}}),i.given_answer=n,m.debug&&console.log(i.given_answer),o?c(i,t):!0;case"multiple_image_choice":var n=[],s=g.find(".multiple-image-choice");return s.each(function(i){e(this).data("selected")&&n.push(e(this).data("slug"))}),0!=n.length?(i.given_answer=n,m.debug&&console.log(i.given_answer),!0):(t=i.errors.required?i.errors.required:g.settings.errors.multiple_image_choice.required,c(i,t));case"textarea":var r=e("textarea").val();return r?i.given_answer=r:i.given_answer="",m.debug&&console.log(i.given_answer),!0}}function r(e){var i=e.data("step");if(!(i>_||x==i)){g.settings.steps[i];x=i,t(g),g.settings.onPrevStep()}}function c(e,i){var t=g.find("#wow-alert");return t.html(i),t.fadeIn(300),setTimeout(function(){t.fadeOut(300)},1500),!1}function l(i){if(i.given_answer)switch(i.type){case"single_choice":e(".single-choice-button").each(function(t){i.given_answer==e(this).data("value")&&e(this).find("i").fadeIn(200)});break;case"multiple_choice":e(".fancy-checkbox").each(function(t){var n=e(this).find("button");-1!=i.given_answer.indexOf(n.data("value"))&&b.selectButton(n)});break;case"form":e("input").each(function(t){i.given_answer[t]&&e(this).val(i.given_answer[t])});break;case"multiple_image_choice":var t=g.find(".multiple-image-choice");t.each(function(t){if(-1!=i.given_answer.indexOf(e(this).data("slug"))){var n=e(this);n.isAvailable=!0,f("multiple_image_choice",n)}});break;case"textarea":g.find("textarea").val(i.given_answer)}}function d(){g.html(p());var i={};e.each(g.settings.steps,function(e,t){var n=t.given_answer,a=t.name;if(t.isDependent)for(var o=0;o<t.steps.length;o++){var s=t.steps[o];if(s.given_answer){n=s.given_answer,a=s.name;break}}i[a]=n}),g.settings.onFinish(i)}function u(i){var t=e('<div class="wow-wizard-step" type="'+i.type+'"></div>');if(i.notes){var n=e('<div class="col-xs-9 wow-wizard-content"></div>');$notes=e('<div class="col-xs-3 wow-wizard-content"></div>'),$notes.html(i.notes),t.append($notes)}else var n=e('<div class="col-xs-12 wow-wizard-content"></div>');t.append(e('<div class="loader"></div>'));var a=e('<div class="wow-wizard-step-question"></div>');a.append(e('<h2 class="wow-wizard-step-question-title">'+i.questionTitle+"</h2>")),i.questionDescription?a.append(e('<p class="wow-wizard-step-question-description">'+i.questionDescription+"</p>")):null;var o=e('<div class="wow-wizard-step-answers"></div>');switch(i.type){case"single_choice":e.each(i.answers,function(t,n){o.append(e('<div class="single-choice-button" data-name="'+i.name+'" data-value="'+n.value+'"><i class="fa fa-check"></i>'+n.text+"</div>"))});break;case"multiple_choice":try{var s=e('<div class="multiple-choice-choices"></div>');e.each(i.answers,function(i,t){var n=e('<span class="fancy-checkbox"></span>');n.append(e('<button type="button" data-value="'+t.value+'" class="button multiple-choice-choice" data-checked="false" style="margin-right:10px;" data-color="info">'+t.text+"</button>")),n.append(e('<input style="display:none;" type="checkbox" name="'+t.value+'">')),s.append(n)}),o.append(s)}catch(r){console.log(r)}break;case"form":try{for(var c=e('<div class="input-row"></div>'),l=0;l<i.inputs.length;l++){var d=i.inputs[l],u=e('<input class="pull-left" name="'+d.name+'" type="'+d.type+'">');d.placeholder?u.attr("placeholder",d.placeholder):null;var p=e('<div class="input-col-6"></div>');p.append(u),d.required&&(p.prepend(e('<div class="star-icon">*</div>')),u.data("required",!0)),c.append(p)}o.append(c)}catch(r){throw console.log(r),new Error('Input array of a step type "form" cannot be empty.')}break;case"multiple_image_choice":try{for(var f=e('<div class="multiple-image-choices"></div>'),l=0;l<i.answers.length;l++){var h=i.answers[l],v=e('<div class="multiple-image-choice" data-slug="'+h.slug+'"></div>'),w=e('<div class="multiple-image-container" style="background-image:url(\''+h.imageUrl+"')\"/>"),b=e("<p>"+h.name+"</p>"),x=e('<div class="circle-select"><div class="background"></div><div class="inner-circle-icon"></div></div>');v.append(w),v.append(b),v.append(x),f.append(v)}o.append(f)}catch(r){console.log(r.message)}break;case"textarea":o.append('<textarea name="'+i.name+'"></textarea>')}n.append(a),n.append(o),m.shouldHaveNextButton(i)&&n.append(e('<div id="wow-wizard-next-step" class="pull-right">'+g.settings.nextButtonText+"</div>")),n.append(e('<div id="wow-alert" style="display:none;"></div>'));for(var _=e('<div class="wow-wizard-step-indicators col-xs-12"></div>'),l=0;l<g.settings.steps.length;l++){var k=e('<div class="wow-wizard-step-indicator" data-step="'+l+'"><div class="step-id"><span>'+(l+1)+"</span></div><b>"+g.settings.steps[l].indicatorName+"</b></div>");_.append(k)}return t.prepend(n),t.prepend(_),t}function p(){var i=e('<div class="wow-wizard-last-step"><h1>Thanks for using WowWizard!</h1><p>We\'ve got all your information. Will reach you soon.</p><a href="#">RETURN HOME</a></div>');return i}function f(e,i){if(i.isAvailable)switch(e){case"room_choice":if(i.isCustom||(i.isAvailable=!1),i.css("color","white"),i.find("i").fadeIn(200,function(){i.isAvailable=!0,i.data("selected",!0)}),i.animate({backgroundColor:"#59BAFF"},200,null),i.isCustom){var t=i.find("input");t.css("color","white"),t.css("border-bottom","1px solid white")}break;case"multiple_image_choice":i.find(".circle-select").addClass("selected"),i.find(".circle-select .background").fadeIn(200),i.find(".circle-select .inner-circle-icon").fadeIn(200),i.data("selected",!0)}}function h(e,i){if(i.isAvailable)switch(e){case"room_choice":i.isCustom||(i.isAvailable=!1),i.css("color","#59BAFF"),i.animate({backgroundColor:"transparent"},200,null),i.find("i").fadeOut(200,function(){i.isAvailable=!0,i.data("selected",!1)}),i.isCustom&&(i.find("input").css("color","#59BAFF"),i.find("input").css("border-bottom","1px solid #59BAFF"));break;case"multiple_image_choice":i.find(".circle-select").removeClass("selected"),i.find(".circle-select .background").fadeOut(200),i.find(".circle-select .inner-circle-icon").fadeOut(200),i.data("selected",!1)}}e.fn.wowWizard.defaults={steps:[],theme:"pomegranate",loader:"../../img/loader.gif",errors:{form:{required:"You have to fill in all required fields.",email:"Wrong e-mail format."},multiple_choice:{required:"You have to fill in all required fields."},single_choice:{required:"You have to fill in all required fields."}},onNextStep:function(){},onPrevStep:function(){},onFinish:function(e){}};var v=e.extend({},e.fn.wowWizard.defaults,i);v.errors=e.extend({},e.fn.wowWizard.defaults.errors,i.errors),this.settings=v;var g=this,w=function(){var i={pomegranate:{activeIndicatorBackgroundColor:"#F44A56",activeIndicatorTextColor:"#FFF",questionAndAnswerTextColor:"#69181E",circleColor:"#C23640",outlineColor:"#F44A56",lineColor:"#F44A56",buttonBackgroundColor:"#F44A56",buttonTextColor:"#FFF",imageChoiceBorderColor:"#F44A56",imageChoiceCircleBackgroundColor:"#FFB3B8"}},t=function(t,n){var a=i[g.settings.theme];t.find(".wow-wizard-step-indicator.visited .step-id").css("background-color",a.circleColor),t.find(".wow-wizard-step-indicator").css("color",a.activeIndicatorTextColor),t.find(".wow-wizard-step-indicator.visited").css("background-color",a.activeIndicatorBackgroundColor),t.find(".wow-wizard-step-indicator").filter(function(i){return!e(this).hasClass("visited")}).css("color",a.textColor),t.find(".wow-wizard-step-indicators").css("border-bottom","2px solid "+a.lineColor),t.find("#wow-wizard-next-step, .single-choice-button").css("background-color",a.buttonBackgroundColor),t.find("#wow-wizard-next-step, .single-choice-button").css("color",a.buttonTextColor),t.find(".multiple-image-choice .circle-select .background").css("background-color",a.imageChoiceCircleBackgroundColor),t.find(".multiple-image-choice, .multiple-image-choice .circle-select").css("border","2px solid "+a.imageChoiceBorderColor),t.find("input[type=text], textarea").css("outline","none"),t.find("input[type=text]:focus, textarea:focus").css({border:"2px solid "+a.outlineColor,"box-shadow":"0px 0px 5px 0px rgba(244,74,85,1);"}),t.find("input[type=text], input[type=email], textarea").focus(function(){e(this).css({border:"1px solid "+a.outlineColor,"-webkit-box-shadow":"0px 0px 5px 0px "+a.outlineColor,"box-shadow":"0px 0px 5px 0px "+a.outlineColor})}),t.find("input[type=text], input[type=email], textarea").blur(function(){e(this).css({border:"1px solid #BBB","-webkit-box-shadow":"none"})}),t.find(".input-col-6 .star-icon").css("color",a.outlineColor),t.find(".multiple-image-choice .circle-select .background").css("background-color"),t.find(".loader").css("background-image","url('"+g.settings.loader+"')")};return{apply:t,colors:i[g.settings.theme]}}(),m=function(){var e={shouldHaveNextButton:["form","multiple_choice","multiple_image_choice","textarea"],allowedStepTypes:["single_choice","form","multiple_choice","multiple_image_choice","textarea"]};return{shouldHaveNextButton:function(i){return-1!=e.shouldHaveNextButton.indexOf(i.type)},isStepTypeAllowed:function(i){return-1!=e.allowedStepTypes.indexOf(i.type)},debug:!1}}(),b=function(){function i(e,i){var t=i.is(":checked");e.data("state",t?"on":"off"),e.find(".state-icon").removeClass().addClass("state-icon "+v[e.data("state")].icon),t?e.removeClass("btn-default").addClass("btn-"+e.data("color")+" active"):e.removeClass("btn-"+e.data("color")+" active").addClass("btn-default")}function t(e,t){i(e,t),0==e.find(".state-icon").length&&e.prepend('<i class="state-icon '+v[e.data("state")].icon+'"></i> ')}function n(){e(".fancy-checkbox").each(function(){var n=e(this),a=n.find("button"),o=n.find("input:checkbox");a.data("color");a.unbind().on("click",function(){o.prop("checked",!o.is(":checked")),o.triggerHandler("change"),i(a,o),a.css("background-color",w.colors.buttonBackgroundColor)}),o.on("change",function(){i(a,o)}),t(a,o)})}return v={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}},{update:function(){n()},selectButton:function(e){n(),e.triggerHandler("click")}}}(),x=0,_=0;t(this)}}(jQuery);